{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/kobby/Desktop/spartahacks/frontend/app/api/call-status/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\n\nexport interface CallEvent {\n  callId: string;\n  caller: string;\n  verdict: \"SCAM\" | \"SAFE\" | \"UNCERTAIN\";\n  status: string;\n  transcript: string;\n  analysis: {\n    label?: string;\n    confidence?: number;\n    reasons?: string[];\n  };\n  timestamp: string;\n  blocked?: boolean;\n}\n\n// In-memory storage for MVP demo\nconst callEvents: CallEvent[] = [];\nconst blocklist: Set<string> = new Set();\nconst MAX_EVENTS = 100;\n\n// POST - receive call status from Teli adapter\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n\n    const event: CallEvent = {\n      callId: body.callId || `call-${Date.now()}`,\n      caller: body.caller || \"Unknown\",\n      verdict: body.verdict || \"UNCERTAIN\",\n      status: body.status || \"completed\",\n      transcript: body.transcript || \"\",\n      analysis: body.analysis || {},\n      timestamp: new Date().toISOString(),\n      blocked: blocklist.has(body.caller),\n    };\n\n    // Add to front of array (newest first)\n    callEvents.unshift(event);\n\n    // Keep only last N events\n    if (callEvents.length > MAX_EVENTS) {\n      callEvents.pop();\n    }\n\n    console.log(`[CallStatus] Received: ${event.verdict} from ${event.caller}`);\n\n    return NextResponse.json({ ok: true, event });\n  } catch (err: any) {\n    console.error(\"[CallStatus] Error:\", err);\n    return NextResponse.json({ ok: false, error: err.message }, { status: 500 });\n  }\n}\n\n// GET - retrieve recent call events\nexport async function GET(req: NextRequest) {\n  const { searchParams } = new URL(req.url);\n  const limit = parseInt(searchParams.get(\"limit\") || \"20\");\n\n  return NextResponse.json({\n    ok: true,\n    events: callEvents.slice(0, limit),\n    blocklist: Array.from(blocklist),\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAiBA,iCAAiC;AACjC,MAAM,aAA0B,EAAE;AAClC,MAAM,YAAyB,IAAI;AACnC,MAAM,aAAa;AAGZ,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAE3B,MAAM,QAAmB;YACvB,QAAQ,KAAK,MAAM,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;YAC3C,QAAQ,KAAK,MAAM,IAAI;YACvB,SAAS,KAAK,OAAO,IAAI;YACzB,QAAQ,KAAK,MAAM,IAAI;YACvB,YAAY,KAAK,UAAU,IAAI;YAC/B,UAAU,KAAK,QAAQ,IAAI,CAAC;YAC5B,WAAW,IAAI,OAAO,WAAW;YACjC,SAAS,UAAU,GAAG,CAAC,KAAK,MAAM;QACpC;QAEA,uCAAuC;QACvC,WAAW,OAAO,CAAC;QAEnB,0BAA0B;QAC1B,IAAI,WAAW,MAAM,GAAG,YAAY;YAClC,WAAW,GAAG;QAChB;QAEA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,MAAM,OAAO,CAAC,MAAM,EAAE,MAAM,MAAM,EAAE;QAE1E,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAM;IAC7C,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF;AAGO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,QAAQ,SAAS,aAAa,GAAG,CAAC,YAAY;IAEpD,OAAO,4JAAY,CAAC,IAAI,CAAC;QACvB,IAAI;QACJ,QAAQ,WAAW,KAAK,CAAC,GAAG;QAC5B,WAAW,MAAM,IAAI,CAAC;IACxB;AACF"}}]
}